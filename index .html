<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ù†ØªØ±</title>
<style>
body{font-family:sans-serif;background:#f4f6f9;padding:20px;}
.container{max-width:600px;margin:auto;background:#fff;padding:20px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
.card{background:#fafafa;border-radius:12px;padding:15px;margin-bottom:15px;}
h1{text-align:center;color:#1a73e8;margin-bottom:5px;}
input{width:100%;padding:10px;margin:6px 0;border:1px solid #ccc;border-radius:8px;}
button{width:100%;padding:10px;border:none;border-radius:8px;color:#fff;font-weight:bold;cursor:pointer;margin-top:5px;}
.btn-present{background:#34a853;}
.btn-absent{background:#ea4335;}
</style>
</head>
<body>

<script>
// Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±
const PASSWORD = "102008302962"; 
let entered = prompt("Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø¯Ø®ÙˆÙ„:");
if(entered !== PASSWORD){
    alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£! Ø³ÙŠØªÙ… ØºÙ„Ù‚ Ø§Ù„ØµÙØ­Ø©.");
    document.body.innerHTML = "";
    throw new Error("Wrong password");
}
</script>

<div class="container">

<h1>Ø£Ø³ØªØ§Ø° Ø­Ø³Ù† Ù…Ù…Ø¯ÙˆØ­</h1>

<div class="card">
<h3>â• ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
<input type="number" id="sid" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨">
<input type="text" id="sname" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
<input type="text" id="centerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ù†ØªØ±">
<input type="text" id="parentPhone" placeholder="Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±">
<input type="text" id="studentPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
<button style="background:#1a73e8" onclick="saveStudent()">Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨</button>
</div>

<div class="card">
<h3>âœ… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</h3>
<input type="number" id="cid" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨">
<button class="btn-present" onclick="processStatus('Ø­Ø§Ø¶Ø±')">Ø­Ø§Ø¶Ø±</button>
<button class="btn-absent" onclick="processStatus('ØºØ§Ø¦Ø¨')">ØºØ§Ø¦Ø¨</button>
</div>

</div>

<script>
const centerNumbers = ["201011111111","201022222222"];

function formatPhone(phone){
phone = phone.trim();
if(!phone.startsWith("2")) return "2"+phone;
return phone;
}

// Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ localStorage
function saveStudent(){
const id = sid.value.trim();
const name = sname.value.trim();
const center = centerName.value.trim();
const parent = formatPhone(parentPhone.value.trim());
const student = formatPhone(studentPhone.value.trim());

if(!id||!name||!center||!parent||!student){ alert("Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"); return;}

let students = JSON.parse(localStorage.getItem("students"))||[];

if(students.find(s=>s.id===id)){ alert("Ø§Ù„ÙƒÙˆØ¯ Ù…ØªØ³Ø¬Ù„"); return;}

students.push({id,name,center,parent,student,present:0,absent:0,history:[]});
localStorage.setItem("students",JSON.stringify(students));
alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨ âœ…");

sid.value=""; sname.value=""; centerName.value=""; parentPhone.value=""; studentPhone.value="";
}

// ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø£Ùˆ ØºÙŠØ§Ø¨ Ù…Ø¹ Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ
function processStatus(status){
const id = cid.value.trim();
if(!id){ alert("Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯"); return;}

let students = JSON.parse(localStorage.getItem("students"))||[];
let student = students.find(s=>s.id===id);

if(!student){ alert("Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…Ø³Ø¬Ù„"); return;}

status==="Ø­Ø§Ø¶Ø±"? student.present++ : student.absent++;

let now = new Date();
let date = now.toLocaleDateString('ar-EG');
let time = now.toLocaleTimeString('ar-EG');

student.history.push({date,time,status});

localStorage.setItem("students",JSON.stringify(students));

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
let msg = `ğŸ“¢ Ø¥Ø´Ø¹Ø§Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ø§Ù„Ø¨
Ù†Ø­ÙŠØ· Ø³ÙŠØ§Ø¯ØªÙƒÙ… Ø¹Ù„Ù…Ø§Ù‹ Ø¨Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨: ${student.name}
Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙŠÙˆÙ…: ${status}
ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${date}
â° Ø§Ù„ÙˆÙ‚Øª: ${time}
ğŸ« Ø§Ù„Ø³Ù†ØªØ±: ${student.center}
Ù…Ø¹ Ø®Ø§Ù„Øµ ØªÙ…Ù†ÙŠØ§ØªÙ†Ø§ Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ ğŸŒŸ
*ØªÙŠÙ… Ø£Ø³ØªØ§Ø° Ø­Ø³Ù† Ù…Ù…Ø¯ÙˆØ­*`;

[student.parent,student.student,...centerNumbers].forEach(phone=>{
window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`,"_blank");
});

cid.value="";
}
</script>

</body>
</html>